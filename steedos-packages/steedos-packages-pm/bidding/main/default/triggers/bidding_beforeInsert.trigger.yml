name: bidding_beforeInsert
listenTo: bidding
when:
  - beforeInsert
isEnabled: true
handler: |-
  const { doc } = ctx.params
  const project = doc.project_program;
  const project_program = await ctx.broker.call('objectql.findOne',
      {
          'objectName': 'project_program',
          'id': project,
          'query': { 'fields': ['_id', 'enable'] }
      }
  )
  if (!project_program.enable) {
      throw new Error('当前项目未启用！')
  }
