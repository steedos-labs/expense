{"name":"付款审批","state":"enabled","is_deleted":false,"is_valid":true,"space":"655f07b6d5cbdc05c07fb284","app":"workflow","created":"2023-11-23T08:05:21.621Z","modified":"2023-11-23T08:24:59.945Z","modified_by":"655f07b1d5cbdc05c07fb282","category":"655f07b6d5cbdc05c07fb284_4631389967384d6dfa253fc6","instance_style":"table","current":{"_id":"4288f27476e1fd064a47a4bc","form":"787e5b26cbf69399fe42ec70","_rev":1,"created":"2023-11-23T08:05:21.621Z","modified":"2023-11-23T08:24:59.943Z","fields":[{"name":"合同","code":"contract","is_wide":false,"is_list_display":false,"is_searchable":true,"is_required":false,"is_multiselect":false,"type":"master_detail","reference_to":"contracts","config":"{}","_id":"6559a6943b502605bf3dd138"},{"name":"项目","code":"project","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"master_detail","reference_to":"project","config":"{}","_id":"6559a6943b502605bf3dd139"},{"name":"收款方","code":"supplier","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":true,"is_multiselect":false,"type":"lookup","reference_to":"accounts","config":"{}","_id":"6559a6943b502605bf3dd13a"},{"name":"币种","code":"currency","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"lookup","reference_to":"currency","config":"{}","_id":"6559a6943b502605bf3dd13b"},{"name":"收款方银行账号","code":"supplier_bank","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":true,"is_multiselect":false,"type":"lookup","reference_to":"account_banks","config":"{}","_id":"6559a6943b502605bf3dd13c"},{"name":"付款金额","code":"amount","is_wide":false,"is_list_display":false,"is_searchable":true,"is_required":true,"is_multiselect":false,"type":"number","digits":2,"_id":"6559a6943b502605bf3dd13d"},{"name":"付款类别","code":"payment_type","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"select","options":"合同付款:合同付款\n其他付款:其他付款","_id":"6559a6943b502605bf3dd13e"},{"name":"计划付款日期","code":"due_date","is_wide":false,"is_list_display":false,"is_searchable":true,"is_required":false,"is_multiselect":false,"type":"date","_id":"6559a6943b502605bf3dd13f"},{"name":"票款方式","code":"ticket_information","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":true,"is_multiselect":false,"default_value":"先票后款","type":"select","options":"先票后款:先票后款\n先款后票:先款后票","_id":"6559a6943b502605bf3dd140"},{"name":"税率","code":"taxrate","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"lookup","reference_to":"tax_rates","config":"{}","_id":"6559a6943b502605bf3dd141"},{"name":"发票台账","code":"payment_invoicefolder","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":true,"type":"lookup","reference_to":"invoices","config":"{\"filters\":[[[[\"type\",\"=\",\"vat_invoice\"],[\"verify_status\",\"=\",\"passed\"]],\"or\",[\"type\",\"!=\",\"vat_invoice\"]],[\"has_used_by_cost\",\"!=\",true]]}","_id":"6559a6943b502605bf3dd142"},{"name":"发票张数","code":"payment_invoicefolder_count","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"number","digits":0,"_id":"6559a6943b502605bf3dd143"},{"name":"发票总金额","code":"payment_invoicefolder_total_amount","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"number","digits":2,"_id":"6559a6943b502605bf3dd144"},{"name":"收款方开户行","code":"account_banks","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"input","_id":"6559a6943b502605bf3dd145"},{"name":"付款单编号","code":"id","is_wide":false,"is_list_display":false,"is_searchable":true,"is_required":false,"is_multiselect":false,"type":"input","_id":"6559a6943b502605bf3dd146"},{"name":"付款说明","code":"amount_description","is_wide":true,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"input","is_textarea":true,"_id":"6559a6943b502605bf3dd147"},{"name":"分类","code":"contract_types_name","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"input","_id":"6559a6943b502605bf3dd148"},{"name":"付款方式","code":"payment_method","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"select","options":"汇款:汇款\n支票:支票\n现金:现金\n其他:其他","_id":"6559a6943b502605bf3dd149"},{"name":"价款类型","code":"amount_type","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"default_value":"immobilization","type":"select","options":"固定:immobilization\n浮动:float\n无金额:no_amount_of","_id":"6559a6943b502605bf3dd14a"},{"name":"合同金额","code":"contract_amount","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"number","digits":2,"_id":"6559a6943b502605bf3dd14b"},{"name":"付款状态","code":"payment_status","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":true,"is_multiselect":false,"type":"select","options":"已支付:paid\n未支付:unpaid","_id":"6559a6943b502605bf3dd14c"},{"name":"付款日期","code":"payment_date","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"date","_id":"6559a6943b502605bf3dd14d"},{"name":"财务单据号","code":"billno","is_wide":false,"is_list_display":false,"is_searchable":false,"is_required":false,"is_multiselect":false,"type":"input","_id":"6559a6943b502605bf3dd14e"}],"modified_by":"655f07b1d5cbdc05c07fb282","start_date":"2023-11-19T06:10:45.049Z","created_by":"655f07b1d5cbdc05c07fb282","name_forumla":"{id}+\"-\"+{amount_description}"},"api_name":"finance_payment","created_by":"655f07b1d5cbdc05c07fb282","company_id":"655f07b6d5cbdc05c07fb284","company_ids":["655f07b6d5cbdc05c07fb284"],"import":true,"owner":"655f07b1d5cbdc05c07fb282","description":null,"error_message":null,"help_text":null,"historys":[],"category_name":"财务管理","instance_number_rules":[],"flows":[{"_id":"cdb3ae27acf5cdfc1f02334b","space":"655f07b6d5cbdc05c07fb284","form":"787e5b26cbf69399fe42ec70","name_formula":"","code_formula":"","is_valid":true,"flowtype":"new","state":"enabled","description":null,"help_text":null,"error_message":"","current_no":0,"is_deleted":false,"created":"2023-11-23T08:05:21.622Z","created_by":"655f07b1d5cbdc05c07fb282","modified":"2023-11-23T08:20:15.113Z","modified_by":"655f07b1d5cbdc05c07fb282","name":"付款审批","app":"workflow","category":"655f07b6d5cbdc05c07fb284_4631389967384d6dfa253fc6","object_name":"finance_payment","instance_fields":[{"name":"contract","filterable":true,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"合同","omit":false,"readonly":false,"reference_to":"contracts","required":false,"searchable":false,"sort_no":50,"sortable":true,"type":"master_detail","create":false,"write_requires_master_read":true,"object_name":"finance_payment","_filtersFunction":"function anonymous(filters,values\n) {\n\n  if(values == undefined){\n    return [];\n  }else{\n    return [[\"payment\",\"=\",true]];\n  }\n\n}"},{"name":"project","filterable":true,"generated":false,"index":false,"is_name":false,"is_wide":false,"label":"项目","primary":false,"readonly":true,"reference_to":"project","required":false,"sort_no":55,"sortable":false,"type":"master_detail","write_requires_master_read":false,"visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"supplier","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"收款方","multiple":false,"omit":false,"readonly":false,"reference_to":"accounts","required":true,"searchable":true,"sort_no":60,"sortable":false,"type":"lookup","create":false,"depend_on":["contract"],"object_name":"finance_payment","_filtersFunction":"function anonymous(filters,values\n) {\n\n    const contract = values.contract;\n    if (!contract) {\n      return ['_id', '=', 'none'];\n    } else {\n      const queryResult = Steedos.authRequest(`/graphql`, {\n                            type: 'POST', async: false, \n                            data: JSON.stringify({\n                              query: `{contracts(filters: [\"_id\",\"=\", `+ JSON.stringify(contract) + `]){_id, othercompany__expand{_id}}}`\n                            })\n                          });\n      const accounts = queryResult && queryResult.data && queryResult.data.contracts[0].othercompany__expand;\n      const ids = new Array();\n      for (const item of accounts) {\n        ids.push(item._id);\n      }\n      return [\"_id\", \"in\", ids];\n    }\n  \n}"},{"name":"currency","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"币种","multiple":false,"omit":false,"readonly":false,"reference_to":"currency","required":false,"searchable":false,"sort_no":130,"sortable":false,"type":"lookup","object_name":"finance_payment"},{"name":"supplier_bank","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"收款方银行账号","create":false,"multiple":false,"omit":false,"depend_on":["supplier"],"readonly":false,"reference_to":"account_banks","required":true,"searchable":false,"sort_no":140,"sortable":false,"type":"lookup","object_name":"finance_payment","_filtersFunction":"function anonymous(filters,values\n) {\n\n    const supplier = values.supplier;\n    if (!supplier) {\n      return ['_id', '=', 'none'];\n    } else {\n      return [[\"account\", \"=\", supplier], [\"enablestate\", \"=\", \"enable\"]];\n    }\n\n}"},{"name":"amount","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"付款金额","omit":false,"precision":18,"readonly":false,"required":true,"scale":2,"searchable":false,"sort_no":150,"sortable":true,"type":"number","object_name":"finance_payment"},{"name":"payment_type","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"付款类别","multiple":false,"omit":false,"options":[{"label":"合同付款","value":"合同付款"},{"label":"其他付款","value":"其他付款"}],"readonly":false,"required":false,"searchable":false,"sort_no":159,"sortable":false,"type":"select","object_name":"finance_payment"},{"name":"due_date","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"计划付款日期","omit":false,"readonly":false,"required":false,"searchable":false,"sort_no":160,"sortable":true,"type":"date","object_name":"finance_payment"},{"name":"ticket_information","defaultValue":"先票后款","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"票款方式","multiple":false,"omit":false,"options":[{"label":"先票后款","value":"先票后款"},{"label":"先款后票","value":"先款后票"}],"readonly":false,"required":true,"searchable":false,"sort_no":160,"sortable":false,"type":"select","object_name":"finance_payment"},{"name":"taxrate","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"税率","multiple":false,"omit":false,"readonly":false,"reference_to":"tax_rates","required":false,"searchable":false,"sort_no":170,"sortable":false,"type":"lookup","object_name":"finance_payment"},{"name":"payment_invoicefolder","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"发票台账","create":false,"multiple":true,"omit":false,"filters":[[[["type","=","vat_invoice"],["verify_status","=","passed"]],"or",["type","!=","vat_invoice"]],["has_used_by_cost","!=",true]],"readonly":false,"reference_to":"invoices","required":false,"searchable":false,"sort_no":188,"sortable":false,"type":"lookup","object_name":"finance_payment"},{"name":"payment_invoicefolder_count","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"发票张数","create":false,"omit":false,"readonly":true,"required":false,"searchable":false,"sort_no":188,"sortable":false,"type":"number","scale":0,"visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"payment_invoicefolder_total_amount","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"发票总金额","create":false,"omit":false,"readonly":true,"required":false,"searchable":false,"sort_no":188,"sortable":false,"type":"number","scale":2,"visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"account_banks","data_type":"text","filterable":false,"formula":"supplier_bank.pk_bankdoc.name","formula_blank_value":"blanks","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"收款方开户行","omit":false,"readonly":false,"required":false,"searchable":false,"sort_no":190,"sortable":false,"type":"formula","visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"id","filterable":true,"formula":"FK-{YYYY}-{0000}","hidden":false,"index":false,"is_name":true,"is_wide":false,"label":"付款单编号","omit":false,"readonly":true,"visible_on":"{{global.mode ==='read' ? true : false}}","required":false,"searchable":false,"sort_no":295,"sortable":true,"type":"autonumber","object_name":"finance_payment"},{"name":"amount_description","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":true,"label":"付款说明","omit":false,"readonly":false,"required":false,"rows":0,"searchable":false,"sort_no":300,"sortable":false,"type":"textarea","object_name":"finance_payment"},{"name":"contract_types_name","data_type":"text","filterable":false,"formula":"contract.contract_type.name","formula_blank_value":"blanks","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"分类","omit":false,"readonly":true,"visible_on":"{{global.mode ==='read' ? true : false}}","required":false,"searchable":false,"sort_no":320,"sortable":false,"type":"formula","object_name":"finance_payment"},{"name":"payment_method","label":"付款方式","type":"select","multiple":false,"options":[{"label":"汇款","value":"汇款"},{"label":"支票","value":"支票"},{"label":"现金","value":"现金"},{"label":"其他","value":"其他"}],"sort_no":330,"object_name":"finance_payment"},{"name":"amount_type","defaultValue":"immobilization","filterable":false,"hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"价款类型","multiple":false,"omit":false,"options":[{"label":"固定","value":"immobilization"},{"label":"浮动","value":"float"},{"label":"无金额","value":"no_amount_of"}],"readonly":true,"required":false,"searchable":false,"sort_no":360,"sortable":false,"type":"select","visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"contract_amount","data_type":"currency","filterable":false,"formula":"contract.amount","formula_blank_value":"zeroes","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"合同金额","omit":false,"precision":18,"readonly":false,"required":false,"scale":2,"searchable":false,"sort_no":630,"sortable":false,"type":"formula","visible_on":"{{global.mode ==='read' ? true : false}}","object_name":"finance_payment"},{"name":"payment_status","filterable":true,"group":"付款信息","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"付款状态","multiple":false,"omit":false,"readonly":false,"options":[{"label":"已支付","value":"paid"},{"label":"未支付","value":"unpaid"}],"required":true,"searchable":false,"sort_no":415,"sortable":false,"type":"select","object_name":"finance_payment"},{"name":"payment_date","filterable":true,"group":"付款信息","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"付款日期","omit":false,"readonly":false,"required":false,"searchable":false,"sort_no":420,"sortable":false,"type":"date","object_name":"finance_payment"},{"name":"billno","filterable":true,"group":"付款信息","hidden":false,"index":false,"is_name":false,"is_wide":false,"label":"财务单据号","omit":false,"readonly":false,"required":false,"searchable":false,"sort_no":430,"sortable":false,"type":"text","object_name":"finance_payment"}],"instance_table_fields":[],"perms":{"_id":"f25136880eaffb5a813a33ea","users_can_add":[],"orgs_can_add":["655f07b6d5cbdc05c07fb284"],"users_can_monitor":[],"orgs_can_monitor":[],"users_can_admin":[],"orgs_can_admin":[]},"current":{"_id":"662f10e32f007e57e20265bb","steps":[{"name":"开始","step_type":"start","deal_type":"","description":"","posx":361.75,"posy":420.5,"timeout_hours":168,"approver_users":[],"approver_orgs":[],"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_step":"","lines":[{"name":"","state":"submitted","to_step":"cd8377b4-0905-45a8-af70-ed8d967c262a","description":"","timeout_line":false,"_id":"kJhGFi8m4guNS8SnQ"}],"permissions":{"__form":"editable","account_banks":"editable","amount":"editable","amount_description":"editable","amount_type":"editable","billno":"editable","contract":"editable","contract_amount":"editable","contract_types_name":"editable","currency":"editable","due_date":"editable","finished":"editable","id":"editable","name":"editable","other_payment_method":"editable","payment_date":"editable","payment_invoicefolder":"editable","payment_invoicefolder_count":"editable","payment_invoicefolder_total_amount":"editable","payment_method":"editable","payment_sacle":"editable","payment_status":"editable","payment_type":"editable","project":"editable","supplier":"editable","supplier_bank":"editable","taxrate":"editable","ticket_information":"editable"},"can_edit_main_attach":false,"can_edit_normal_attach":true,"_id":"aFERrE6gCF8QLHW3w","fields_modifiable":[],"approver_roles_api_name":[],"approver_hr_roles_name":[],"approver_hr_roles_api_name":[],"approver_roles_name":[]},{"name":"结束","step_type":"end","deal_type":"","description":"","posx":1143.25,"posy":420.5,"approver_users":[],"approver_orgs":[],"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_step":"","permissions":{},"_id":"LLYpRnM9vnDQuNaPv","fields_modifiable":[],"approver_roles_api_name":[],"approver_hr_roles_name":[],"approver_hr_roles_api_name":[],"approver_roles_name":[]},{"name":"审批","step_type":"sign","deal_type":"pickupAtRuntime","description":"","posx":750,"posy":416,"timeout_hours":168,"approver_users":[],"approver_orgs":[],"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_hr_roles":[],"approver_step":"","lines":[{"name":"","state":"approved","to_step":"LLYpRnM9vnDQuNaPv","description":"","timeout_line":false}],"permissions":{},"disableCC":false,"allowDistribute":false,"can_edit_main_attach":false,"can_edit_normal_attach":true,"cc_must_finished":false,"cc_alert":false,"allow_pick_approve_users":false,"allow_skip":false,"cc_has_edit_permission":false,"_id":"cd8377b4-0905-45a8-af70-ed8d967c262a","fields_modifiable":[],"approver_roles_api_name":[],"approver_hr_roles_name":[],"approver_hr_roles_api_name":[],"approver_roles_name":[]}],"_rev":1,"flow":"cdb3ae27acf5cdfc1f02334b","form_version":"4288f27476e1fd064a47a4bc","created":"2023-11-23T08:05:21.622Z","created_by":"655f07b1d5cbdc05c07fb282","modified":"2023-11-23T08:05:21.622Z","modified_by":"655f07b1d5cbdc05c07fb282","start_date":"2023-11-19T06:10:45.049Z"},"api_name":"finance_payment","instances":null,"sort_no":null,"forbid_initiate_instance":true,"historys":[],"company_id":"655f07b6d5cbdc05c07fb284","company_ids":["655f07b6d5cbdc05c07fb284"],"import":true,"owner":"655f07b1d5cbdc05c07fb282","object_workflows":[{"_id":"j9Dfk9J8eR9ornsCi","name":"付款审批-付款","object_name":"finance_payment","flow_id":"cdb3ae27acf5cdfc1f02334b","sync_attachment":"lastest","sync_type":"every_step","sync_direction":"both","field_map_back":[{"object_field":"contract","workflow_field":"contract"},{"object_field":"project","workflow_field":"project"},{"object_field":"supplier","workflow_field":"supplier"},{"object_field":"currency","workflow_field":"currency"},{"object_field":"supplier_bank","workflow_field":"supplier_bank"},{"object_field":"amount","workflow_field":"amount"},{"object_field":"payment_type","workflow_field":"payment_type"},{"object_field":"due_date","workflow_field":"due_date"},{"object_field":"ticket_information","workflow_field":"ticket_information"},{"object_field":"taxrate","workflow_field":"taxrate"},{"object_field":"payment_invoicefolder","workflow_field":"payment_invoicefolder"},{"object_field":"payment_invoicefolder_count","workflow_field":"payment_invoicefolder_count"},{"object_field":"payment_invoicefolder_total_amount","workflow_field":"payment_invoicefolder_total_amount"},{"object_field":"account_banks","workflow_field":"account_banks"},{"object_field":"id","workflow_field":"id"},{"object_field":"amount_description","workflow_field":"amount_description"},{"object_field":"contract_types_name","workflow_field":"contract_types_name"},{"object_field":"payment_method","workflow_field":"payment_method"},{"object_field":"amount_type","workflow_field":"amount_type"},{"object_field":"contract_amount","workflow_field":"contract_amount"},{"object_field":"payment_status","workflow_field":"payment_status"},{"object_field":"payment_date","workflow_field":"payment_date"},{"object_field":"billno","workflow_field":"billno"}],"field_map":[{"object_field":"contract","workflow_field":"contract"},{"object_field":"project","workflow_field":"project"},{"object_field":"supplier","workflow_field":"supplier"},{"object_field":"currency","workflow_field":"currency"},{"object_field":"supplier_bank","workflow_field":"supplier_bank"},{"object_field":"amount","workflow_field":"amount"},{"object_field":"payment_type","workflow_field":"payment_type"},{"object_field":"due_date","workflow_field":"due_date"},{"object_field":"ticket_information","workflow_field":"ticket_information"},{"object_field":"taxrate","workflow_field":"taxrate"},{"object_field":"payment_invoicefolder","workflow_field":"payment_invoicefolder"},{"object_field":"payment_invoicefolder_count","workflow_field":"payment_invoicefolder_count"},{"object_field":"payment_invoicefolder_total_amount","workflow_field":"payment_invoicefolder_total_amount"},{"object_field":"account_banks","workflow_field":"account_banks"},{"object_field":"id","workflow_field":"id"},{"object_field":"amount_description","workflow_field":"amount_description"},{"object_field":"contract_types_name","workflow_field":"contract_types_name"},{"object_field":"payment_method","workflow_field":"payment_method"},{"object_field":"amount_type","workflow_field":"amount_type"},{"object_field":"contract_amount","workflow_field":"contract_amount"},{"object_field":"payment_status","workflow_field":"payment_status"},{"object_field":"payment_date","workflow_field":"payment_date"},{"object_field":"billno","workflow_field":"billno"}],"lock_record_after_approval":true}]}]}